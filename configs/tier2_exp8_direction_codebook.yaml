# Stage 3 - Experiment 8: Direction Codebook Feasibility (Mimi latents)
#
# Tests whether frame-to-frame direction vectors from Mimi 512D latents
# cluster into a practical codebook. Compares normalized (spherical k-means)
# vs unnormalized (standard k-means on raw deltas) as A/B test.

seed: 42

data:
  latents_dir: /workspace/audioEngram/outputs/tier2/exp9_pocket_mimi_vae/20260209_010912/latents.zarr
  latents_index: /workspace/audioEngram/outputs/tier2/exp9_pocket_mimi_vae/20260209_010912/latents_index.parquet
  splits_dir: ./outputs/phase0/splits

codebook:
  k_values: [64]
  near_zero_epsilons: [0.001, 0.01, 0.1, 0.5]  # multiplied by median magnitude
  kmeans_n_init: 1
  kmeans_max_iter: 300
  kmeans_batch_size: 4096

eval:
  n_utterances: 10
  output_sample_rate: 48000
  # Use Exp9 PocketMimiVAE checkpoint to decode 32D VAE latents back to audio.
  vae_checkpoint: /workspace/audioEngram/outputs/tier2/exp9_pocket_mimi_vae/20260209_010912/checkpoints/vae_gan_final.pt
  mimi_checkpoint: null  # null = HF download

train:
  device: auto

output:
  out_dir: ./outputs/tier3/exp8_direction_codebook
